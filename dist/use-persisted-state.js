var e,r=require("react"),t=(e=require("@use-it/event-listener"))&&"object"==typeof e&&"default"in e?e.default:e,n={},o=function(e,r,t){return n[e]||(n[e]={callbacks:[],value:t}),n[e].callbacks.push(r),{deregister:function(){var t=n[e].callbacks,o=t.indexOf(r);o>-1&&t.splice(o,1)},emit:function(t){n[e].value!==t&&(n[e].value=t,n[e].callbacks.forEach(function(e){r!==e&&e(t)}))}}};module.exports=function(e,n){if(void 0===n&&(n="undefined"!=typeof global&&global.localStorage?global.localStorage:"undefined"!=typeof globalThis&&globalThis.localStorage?globalThis.localStorage:"undefined"!=typeof window&&window.localStorage?window.localStorage:"undefined"!=typeof localStorage?localStorage:null),n){var a=function(e){return{get:function(r,t){var n=e.getItem(r);if(null==n)return"function"==typeof t?t():t;try{return JSON.parse(n)}catch(e){return console.error('Error parsing JSON for key "'+r+'":',e),"function"==typeof t?t():t}},set:function(r,t){e.setItem(r,JSON.stringify(t))}}}(n);return function(n){return function(e,n,a){var l=a.get,u=a.set,c=r.useRef(null),i=r.useState(function(){return l(n,e)}),f=i[0],s=i[1];t("storage",function(e){var r=e.newValue;if(e.key===n)try{var t=JSON.parse(r);f!==t&&s(t)}catch(e){console.error('Error parsing JSON for key "'+n+'":',e),f!==r&&s(r)}}),r.useEffect(function(){return c.current=o(n,s,e),function(){c.current.deregister()}},[e,n]);var g=r.useCallback(function(e){var r="function"==typeof e?e(f):e;u(n,r),s(r),c.current.emit(e)},[f,u,n]);return[f,g]}(n,e,a)}}return r.useState};
